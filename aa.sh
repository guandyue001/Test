#!/bin/bash
export UUID=${UUID:-'0ff0350e-c001-495b-a6a1-13b962590375'}
export ARGO_DOMAIN=${ARGO_DOMAIN:-'deepnote.guandyue.ip-ddns.com'}          # 固定隧道域名，留空即启用临时隧道
export ARGO_AUTH=${ARGO_AUTH:-'eyJhIjoiODVhOGVmOTM0NjY5NDAyYjgwYzljNDk0NTA5Mjg4YWUiLCJ0IjoiOTlmMjI3YmUtM2IyNC00ZDE4LWExMTEtMzRhOGMyZWZiMDhkIiwicyI6IlkyVXhPR0ZoTWpNdE0yWXlZUzAwT1dFM0xUZzRaRE10WmpJNE5HWTJNbUkwWXpObCJ9'}             # 固定隧道json或token，留空即启用临时隧道，json可在 https://fscarmen.cloudflare.now.cc 获取
export CFIP=${CFIP:-'www.epicgames.com'}         # 优选域名或优选ip
export CFPORT=${CFPORT:-'443'}               # 优选域名或优选ip对应端口
export NAME=${NAME:-'Vls'}                 # 节点名称
export FILE_PATH=${FILE_PATH:-'./world'}        # 节点存放文件夹
export ARGO_PORT=${ARGO_PORT:-'8001'}          # Argo端口,使用固定隧道token需在cf后台设置的端口和这里一致

echo "WyAhIC1kICIke0ZJTEVfUEFUSH0iIF0gJiYgbWtkaXIgJHtGSUxFX1BBVEh9CgpybSAtcmYgJHtGSUxFX1BBVEh9L2Jvb3QubG9nICR7RklMRV9QQVRIfS9zdWIudHh0ICR7RklMRV9QQVRIfS9jb25maWcuanNvbiAke0ZJTEVfUEFUSH0vdHVubmVsLmpzb24gJHtGSUxFX1BBVEh9L3R1bm5lbC55bWwgPi9kZXYvbnVsbCAyPiYxCgphcmdvX2NvbmZpZ3VyZSgpIHsKICBpZiBbWyAteiAkQVJHT19BVVRIIHx8IC16ICRBUkdPX0RPTUFJTiBdXTsgdGhlbgogICAgZWNobyAtZSAiXGVbMTszMm1BUkdPX0RPTUFJTiBvciBBUkdPX0FVVEggdmFyaWFibGUgaXMgZW1wdHksIHVzZSBxdWljayB0dW5uZWxzXGVbMG0iCiAgICByZXR1cm4KICBmaQoKICBpZiBbWyAkQVJHT19BVVRIID1+IFR1bm5lbFNlY3JldCBdXTsgdGhlbgogICAgZWNobyAkQVJHT19BVVRIID4gJHtGSUxFX1BBVEh9L3R1bm5lbC5qc29uCiAgICBjYXQgPiAke0ZJTEVfUEFUSH0vdHVubmVsLnltbCA8PCBFT0YKdHVubmVsOiAkKGN1dCAtZFwiIC1mMTIgPDw8ICIkQVJHT19BVVRIIikKY3JlZGVudGlhbHMtZmlsZTogJHtGSUxFX1BBVEh9L3R1bm5lbC5qc29uCnByb3RvY29sOiBodHRwMgoKaW5ncmVzczoKICAtIGhvc3RuYW1lOiAkQVJHT19ET01BSU4KICAgIHNlcnZpY2U6IGh0dHA6Ly9sb2NhbGhvc3Q6JEFSR09fUE9SVAogICAgb3JpZ2luUmVxdWVzdDoKICAgICAgbm9UTFNWZXJpZnk6IHRydWUKICAtIHNlcnZpY2U6IGh0dHBfc3RhdHVzOjQwNApFT0YKICBlbHNlCiAgICBlY2hvIC1lICJcZVsxOzMybUFSR09fQVVUSCBtaXNtYXRjaCBUdW5uZWxTZWNyZXQsdXNlIHRva2VuIGNvbm5lY3QgdG8gdHVubmVsXGVbMG0iCiAgZmkKfQphcmdvX2NvbmZpZ3VyZQp3YWl0CgpnZW5lcmF0ZV9jb25maWcoKSB7CiAgY2F0ID4gJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uIDw8IEVPRgp7CiAgImxvZyI6IHsgImFjY2VzcyI6ICIvZGV2L251bGwiLCAiZXJyb3IiOiAiL2Rldi9udWxsIiwgImxvZ2xldmVsIjogIm5vbmUiIH0sCiAgImluYm91bmRzIjogWwogICAgewogICAgICAicG9ydCI6ICRBUkdPX1BPUlQsCiAgICAgICJwcm90b2NvbCI6ICJ2bGVzcyIsCiAgICAgICJzZXR0aW5ncyI6IHsKICAgICAgICAiY2xpZW50cyI6IFt7ICJpZCI6ICIke1VVSUR9IiwgImZsb3ciOiAieHRscy1ycHJ4LXZpc2lvbiIgfV0sCiAgICAgICAgImRlY3J5cHRpb24iOiAibm9uZSIsCiAgICAgICAgImZhbGxiYWNrcyI6IFsKICAgICAgICAgIHsgImRlc3QiOiAzMDAxIH0sIHsgInBhdGgiOiAiL3ZsZXNzLWFyZ28iLCAiZGVzdCI6IDMwMDIgfSwKICAgICAgICAgIHsgInBhdGgiOiAiL3ZtZXNzLWFyZ28iLCAiZGVzdCI6IDMwMDMgfSwgeyAicGF0aCI6ICIvdHJvamFuLWFyZ28iLCAiZGVzdCI6IDMwMDQgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgInN0cmVhbVNldHRpbmdzIjogeyAibmV0d29yayI6ICJ0Y3AiIH0KICAgIH0sCiAgICB7CiAgICAgICJwb3J0IjogMzAwMSwgImxpc3RlbiI6ICIxMjcuMC4wLjEiLCAicHJvdG9jb2wiOiAidmxlc3MiLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iIH1dLCAiZGVjcnlwdGlvbiI6ICJub25lIiB9LAogICAgICAic3RyZWFtU2V0dGluZ3MiOiB7ICJuZXR3b3JrIjogIndzIiwgInNlY3VyaXR5IjogIm5vbmUiIH0KICAgIH0sCiAgICB7CiAgICAgICJwb3J0IjogMzAwMiwgImxpc3RlbiI6ICIxMjcuMC4wLjEiLCAicHJvdG9jb2wiOiAidmxlc3MiLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iLCAibGV2ZWwiOiAwIH1dLCAiZGVjcnlwdGlvbiI6ICJub25lIiB9LAogICAgICAic3RyZWFtU2V0dGluZ3MiOiB7ICJuZXR3b3JrIjogIndzIiwgInNlY3VyaXR5IjogIm5vbmUiLCAid3NTZXR0aW5ncyI6IHsgInBhdGgiOiAiL3ZsZXNzLWFyZ28iIH0gfSwKICAgICAgInNuaWZmaW5nIjogeyAiZW5hYmxlZCI6IHRydWUsICJkZXN0T3ZlcnJpZGUiOiBbImh0dHAiLCAidGxzIiwgInF1aWMiXSwgIm1ldGFkYXRhT25seSI6IGZhbHNlIH0KICAgIH0sCiAgICB7CiAgICAgICJwb3J0IjogMzAwMywgImxpc3RlbiI6ICIxMjcuMC4wLjEiLCAicHJvdG9jb2wiOiAidm1lc3MiLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgImlkIjogIiR7VVVJRH0iLCAiYWx0ZXJJZCI6IDAgfV0gfSwKICAgICAgInN0cmVhbVNldHRpbmdzIjogeyAibmV0d29yayI6ICJ3cyIsICJ3c1NldHRpbmdzIjogeyAicGF0aCI6ICIvdm1lc3MtYXJnbyIgfSB9LAogICAgICAic25pZmZpbmciOiB7ICJlbmFibGVkIjogdHJ1ZSwgImRlc3RPdmVycmlkZSI6IFsiaHR0cCIsICJ0bHMiLCAicXVpYyJdLCAibWV0YWRhdGFPbmx5IjogZmFsc2UgfQogICAgfSwKICAgIHsKICAgICAgInBvcnQiOiAzMDA0LCAibGlzdGVuIjogIjEyNy4wLjAuMSIsICJwcm90b2NvbCI6ICJ0cm9qYW4iLAogICAgICAic2V0dGluZ3MiOiB7ICJjbGllbnRzIjogW3sgInBhc3N3b3JkIjogIiR7VVVJRH0iIH1dIH0sCiAgICAgICJzdHJlYW1TZXR0aW5ncyI6IHsgIm5ldHdvcmsiOiAid3MiLCAic2VjdXJpdHkiOiAibm9uZSIsICJ3c1NldHRpbmdzIjogeyAicGF0aCI6ICIvdHJvamFuLWFyZ28iIH0gfSwKICAgICAgInNuaWZmaW5nIjogeyAiZW5hYmxlZCI6IHRydWUsICJkZXN0T3ZlcnJpZGUiOiBbImh0dHAiLCAidGxzIiwgInF1aWMiXSwgIm1ldGFkYXRhT25seSI6IGZhbHNlIH0KICAgIH0KICBdLAogICJkbnMiOiB7ICJzZXJ2ZXJzIjogWyJodHRwcytsb2NhbDovLzguOC44LjgvZG5zLXF1ZXJ5Il0gfSwKICAib3V0Ym91bmRzIjogWyB7InByb3RvY29sIjogImZyZWVkb20iLCAidGFnIjogImRpcmVjdCIgfSx7InByb3RvY29sIjogImJsYWNraG9sZSIsInRhZyI6ICJibG9jayIgfSBdCn0KRU9GCn0KZ2VuZXJhdGVfY29uZmlnCndhaXQKCkFSQ0g9JCh1bmFtZSAtbSkgJiYgRE9XTkxPQURfRElSPSIke0ZJTEVfUEFUSH0iICYmIG1rZGlyIC1wICIkRE9XTkxPQURfRElSIiAmJiBGSUxFX0lORk89KCkKaWYgWyAiJEFSQ0giID09ICJhcm0iIF0gfHwgWyAiJEFSQ0giID09ICJhcm02NCIgXSB8fCBbICIkQVJDSCIgPT0gImFhcmNoNjQiIF07IHRoZW4KICAgIEZJTEVfSU5GTz0oImh0dHBzOi8vZ2l0aHViLmNvbS8xMTAzNTY3NzYvd2FyZWhvdXNlL3Jhdy9yZWZzL2hlYWRzL21haW4vRG9ja2VyL0FSTS9ib3QgYm90IiAiaHR0cHM6Ly9naXRodWIuY29tLzExMDM1Njc3Ni93YXJlaG91c2UvcmF3L3JlZnMvaGVhZHMvbWFpbi9Eb2NrZXIvQVJNL3dlYiB3ZWIiKQplbGlmIFsgIiRBUkNIIiA9PSAiYW1kNjQiIF0gfHwgWyAiJEFSQ0giID09ICJ4ODZfNjQiIF0gfHwgWyAiJEFSQ0giID09ICJ4ODYiIF07IHRoZW4KICAgIEZJTEVfSU5GTz0oImh0dHBzOi8vZ2l0aHViLmNvbS8xMTAzNTY3NzYvd2FyZWhvdXNlL3Jhdy9yZWZzL2hlYWRzL21haW4vRG9ja2VyL0FNRC9ib3QgYm90IiAiaHR0cHM6Ly9naXRodWIuY29tLzExMDM1Njc3Ni93YXJlaG91c2UvcmF3L3JlZnMvaGVhZHMvbWFpbi9Eb2NrZXIvQU1EL3dlYiB3ZWIiKQplbHNlCiAgICBlY2hvICJVbnN1cHBvcnRlZCBhcmNoaXRlY3R1cmU6ICRBUkNIIgogICAgZXhpdCAxCmZpCmZvciBlbnRyeSBpbiAiJHtGSUxFX0lORk9bQF19IjsgZG8KICAgIFVSTD0kKGVjaG8gIiRlbnRyeSIgfCBjdXQgLWQgJyAnIC1mIDEpCiAgICBORVdfRklMRU5BTUU9JChlY2hvICIkZW50cnkiIHwgY3V0IC1kICcgJyAtZiAyKQogICAgRklMRU5BTUU9IiRET1dOTE9BRF9ESVIvJE5FV19GSUxFTkFNRSIKICAgIGlmIFsgLWUgIiRGSUxFTkFNRSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIlxlWzE7MzJtJEZJTEVOQU1FIGFscmVhZHkgZXhpc3RzLFNraXBwaW5nIGRvd25sb2FkXGVbMG0iCiAgICBlbHNlCiAgICAgICAgY3VybCAtTCAtc1MgLW8gIiRGSUxFTkFNRSIgIiRVUkwiCiAgICAgICAgZWNobyAtZSAiXGVbMTszMm1Eb3dubG9hZGluZyAkRklMRU5BTUVcZVswbSIKICAgIGZpCmRvbmUKd2FpdAoKcnVuKCkgewogIGlmIFsgLWUgIiR7RklMRV9QQVRIfS93ZWIiIF07IHRoZW4KICAgIGNobW9kIDc3NyAiJHtGSUxFX1BBVEh9L3dlYiIKICAgIG5vaHVwICR7RklMRV9QQVRIfS93ZWIgLWMgJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uID4vZGV2L251bGwgMj4mMSAmCgkgIHNsZWVwIDIKICAgIHBncmVwIC14ICJ3ZWIiID4gL2Rldi9udWxsICYmIGVjaG8gLWUgIlxlWzE7MzJtd2ViIGlzIHJ1bm5pbmdcZVswbSIgfHwgeyBlY2hvIC1lICJcZVsxOzM1bXdlYiBpcyBub3QgcnVubmluZywgcmVzdGFydGluZy4uLlxlWzBtIjsgcGtpbGwgLXggIndlYiIgJiYgbm9odXAgIiR7RklMRV9QQVRIfS93ZWIiIC1jICR7RklMRV9QQVRIfS9jb25maWcuanNvbiA+L2Rldi9udWxsIDI+JjEgJiBzbGVlcCAyOyBlY2hvIC1lICJcZVsxOzMybXdlYiByZXN0YXJ0ZWRcZVswbSI7IH0KICBmaQoKICBpZiBbIC1lICIke0ZJTEVfUEFUSH0vYm90IiBdOyB0aGVuCiAgICBjaG1vZCA3NzcgIiR7RklMRV9QQVRIfS9ib3QiCiAgICBpZiBbWyAkQVJHT19BVVRIID1+IF5bQS1aMC05YS16PV17MTIwLDI1MH0kIF1dOyB0aGVuCiAgICAgIGFyZ3M9InR1bm5lbCAtLWVkZ2UtaXAtdmVyc2lvbiBhdXRvIC0tbm8tYXV0b3VwZGF0ZSAtLXByb3RvY29sIGh0dHAyIHJ1biAtLXRva2VuICR7QVJHT19BVVRIfSIKICAgIGVsaWYgW1sgJEFSR09fQVVUSCA9fiBUdW5uZWxTZWNyZXQgXV07IHRoZW4KICAgICAgYXJncz0idHVubmVsIC0tZWRnZS1pcC12ZXJzaW9uIGF1dG8gLS1jb25maWcgJHtGSUxFX1BBVEh9L3R1bm5lbC55bWwgcnVuIgogICAgZWxzZQogICAgICBhcmdzPSJ0dW5uZWwgLS1lZGdlLWlwLXZlcnNpb24gYXV0byAtLW5vLWF1dG91cGRhdGUgLS1wcm90b2NvbCBodHRwMiAtLWxvZ2ZpbGUgJHtGSUxFX1BBVEh9L2Jvb3QubG9nIC0tbG9nbGV2ZWwgaW5mbyAtLXVybCBodHRwOi8vbG9jYWxob3N0OiRBUkdPX1BPUlQiCiAgICBmaQogICAgbm9odXAgJHtGSUxFX1BBVEh9L2JvdCAkYXJncyA+L2Rldi9udWxsIDI+JjEgJgogICAgc2xlZXAgMgogICAgcGdyZXAgLXggImJvdCIgPiAvZGV2L251bGwgJiYgZWNobyAtZSAiXGVbMTszMm1ib3QgaXMgcnVubmluZ1xlWzBtIiB8fCB7IGVjaG8gLWUgIlxlWzE7MzVtYm90IGlzIG5vdCBydW5uaW5nLCByZXN0YXJ0aW5nLi4uXGVbMG0iOyBwa2lsbCAteCAiYm90IiAmJiBub2h1cCAiJHtGSUxFX1BBVEh9L2JvdCIgJGFyZ3MgPi9kZXYvbnVsbCAyPiYxICYgc2xlZXAgMjsgZWNobyAtZSAiXGVbMTszMm1ib3QgcmVzdGFydGVkXGVbMG0iOyB9CiAgZmkKfSAKcnVuCnNsZWVwIDIKCmdldF9hcmdvZG9tYWluKCkgewogIGlmIFtbIC1uICRBUkdPX0FVVEggXV07IHRoZW4KICAgIGVjaG8gIiRBUkdPX0RPTUFJTiIKICBlbHNlCiAgICBsb2NhbCByZXRyeT0wCiAgICBsb2NhbCBtYXhfcmV0cmllcz02CiAgICBsb2NhbCBhcmdvZG9tYWluPSIiCiAgICB3aGlsZSBbWyAkcmV0cnkgLWx0ICRtYXhfcmV0cmllcyBdXTsgZG8KICAgICAgKChyZXRyeSsrKSkKICAgICAgYXJnb2RvbWFpbj0kKHNlZCAtbiAnc3wuKmh0dHBzOi8vXChbXi9dKnRyeWNsb3VkZmxhcmVcLmNvbVwpLip8XDF8cCcgIiR7RklMRV9QQVRIfS9ib290LmxvZyIpIAogICAgICBpZiBbWyAtbiAkYXJnb2RvbWFpbiBdXTsgdGhlbgogICAgICAgIGJyZWFrCiAgICAgIGZpCiAgICAgIHNsZWVwIDEKICAgIGRvbmUKICAgIGVjaG8gIiRhcmdvZG9tYWluIgogIGZpCn0KCmdlbmVyYXRlX2xpbmtzKCkgewogIGFyZ29kb21haW49JChnZXRfYXJnb2RvbWFpbikKICBlY2hvIC1lICJcZVsxOzMybUFyZ29Eb21haW46XGVbMTszNW0ke2FyZ29kb21haW59XGVbMG0iCiAgc2xlZXAgMgoKICBpc3A9JChjdXJsIC1zIGh0dHBzOi8vc3BlZWQuY2xvdWRmbGFyZS5jb20vbWV0YSB8IGF3ayAtRlwiICd7cHJpbnQgJDI2Ii0iJDE4fScgfCBzZWQgLWUgJ3MvIC9fL2cnKQogIHNsZWVwIDIKCiAgVk1FU1M9InsgXCJ2XCI6IFwiMlwiLCBcInBzXCI6IFwiJHtOQU1FfS0ke2lzcH1cIiwgXCJhZGRcIjogXCIke0NGSVB9XCIsIFwicG9ydFwiOiBcIiR7Q0ZQT1JUfVwiLCBcImlkXCI6IFwiJHtVVUlEfVwiLCBcImFpZFwiOiBcIjBcIiwgXCJzY3lcIjogXCJub25lXCIsIFwibmV0XCI6IFwid3NcIiwgXCJ0eXBlXCI6IFwibm9uZVwiLCBcImhvc3RcIjogXCIke2FyZ29kb21haW59XCIsIFwicGF0aFwiOiBcIi92bWVzcy1hcmdvP2VkPTIwNDhcIiwgXCJ0bHNcIjogXCJ0bHNcIiwgXCJzbmlcIjogXCIke2FyZ29kb21haW59XCIsIFwiYWxwblwiOiBcIlwiIH0iCgogIGNhdCA+ICR7RklMRV9QQVRIfS9saXN0LnR4dCA8PEVPRgp2bGVzczovLyR7VVVJRH1AJHtDRklQfToke0NGUE9SVH0/ZW5jcnlwdGlvbj1ub25lJnNlY3VyaXR5PXRscyZzbmk9JHthcmdvZG9tYWlufSZ0eXBlPXdzJmhvc3Q9JHthcmdvZG9tYWlufSZwYXRoPSUyRnZsZXNzLWFyZ28lM0ZlZCUzRDIwNDgjJHtOQU1FfS0ke2lzcH0KCnZtZXNzOi8vJChlY2hvICIkVk1FU1MiIHwgYmFzZTY0IC13MCkKCnRyb2phbjovLyR7VVVJRH1AJHtDRklQfToke0NGUE9SVH0/c2VjdXJpdHk9dGxzJnNuaT0ke2FyZ29kb21haW59JnR5cGU9d3MmaG9zdD0ke2FyZ29kb21haW59JnBhdGg9JTJGdHJvamFuLWFyZ28lM0ZlZCUzRDIwNDgjJHtOQU1FfS0ke2lzcH0KRU9GCgogIGJhc2U2NCAtdzAgJHtGSUxFX1BBVEh9L2xpc3QudHh0ID4gJHtGSUxFX1BBVEh9L3N1Yi50eHQKICBjYXQgJHtGSUxFX1BBVEh9L3N1Yi50eHQKICBlY2hvIC1lICJcblxlWzE7MzJtJHtGSUxFX1BBVEh9L3N1Yi50eHQgc2F2ZWQgc3VjY2Vzc2Z1bGx5XGVbMG0iCiAgc2xlZXAgNSAgCiAgcm0gLXJmICR7RklMRV9QQVRIfS9saXN0LnR4dCAke0ZJTEVfUEFUSH0vYm9vdC5sb2cgJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uICR7RklMRV9QQVRIfS90dW5uZWwuanNvbiAke0ZJTEVfUEFUSH0vdHVubmVsLnltbCAke0ZJTEVfUEFUSH0vbnBtICR7RklMRV9QQVRIfS93ZWIgJHtGSUxFX1BBVEh9L2JvdAp9CmdlbmVyYXRlX2xpbmtzCmVjaG8gLWUgIlxlWzE7OTZtUnVubmluZyBkb25lIVxlWzBtIgplY2hvIC1lICJcZVsxOzk2bVRoYW5rIHlvdSBmb3IgdXNpbmcgdGhpcyBzY3JpcHQsZW5qb3khXGVbMG0iCnNsZWVwIDE1CmNsZWFy" | base64 -d | bash
